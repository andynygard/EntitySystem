CREATE TABLE [Entity] (
	"Id"	integer PRIMARY KEY AUTOINCREMENT NOT NULL
);

CREATE TABLE [EntityTemplate] (
	"Id"		integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	"EntityId"	integer NOT NULL,
	"Name"		varchar(50) NOT NULL
,
    FOREIGN KEY ([EntityId])
        REFERENCES [Entity]([Id])
);

CREATE UNIQUE INDEX [UX_EntityTemplate]
ON [EntityTemplate]
([EntityId]);

CREATE TABLE [Component] (
	"Id"		integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	"Classname"	varchar(250) NOT NULL
);

CREATE TABLE [EntityComponent] (
	"Id"			integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	"EntityId"		integer NOT NULL,
	"ComponentId"	integer NOT NULL
,
    FOREIGN KEY ([ComponentId])
        REFERENCES [Component]([Id]),
    FOREIGN KEY ([EntityId])
        REFERENCES [Entity]([Id])
);

CREATE UNIQUE INDEX [UX_EntityComponent]
ON [EntityComponent]
([EntityId], [ComponentId]);

CREATE TABLE [Array] (
	"Id"			integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	"Length"		integer NOT NULL,
	"DataType"		varchar(250) NOT NULL
);

CREATE TABLE [ArrayData] (
	"ArrayId"	integer NOT NULL,
	"Index"			integer NOT NULL,
	"Value"			varchar NOT NULL,
    PRIMARY KEY ([ArrayId], [Index])
,
    FOREIGN KEY ([ArrayId])
        REFERENCES [Array]([Id])
);

CREATE TABLE [EntityComponent_Data] (
	"EntityComponentId"	integer NOT NULL,
	"Property"			varchar(50) NOT NULL,
	"Value"				varchar NOT NULL,
	"DataType"			varchar(250) NOT NULL,
    PRIMARY KEY ([EntityComponentId], [Property])
,
    FOREIGN KEY ([EntityComponentId])
        REFERENCES [EntityComponent]([Id])
);

CREATE TABLE [EntityComponent_Array] (
	"EntityComponentId"	integer NOT NULL,
	"Property"			varchar(50) NOT NULL,
	"ArrayId"		integer NOT NULL,
    PRIMARY KEY ([EntityComponentId], [Property])
,
    FOREIGN KEY ([EntityComponentId])
        REFERENCES [EntityComponent]([Id]),
    FOREIGN KEY ([ArrayId])
        REFERENCES [Array]([Id])
);

CREATE TABLE [Level] (
	"Id"			integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	"Number"		integer NOT NULL,
	"Name"			varchar(50) NOT NULL,
	"Description"	varchar(250) NOT NULL
);

CREATE UNIQUE INDEX [UX_Level]
ON [Level]
([Number]);

CREATE TABLE [Level_Entity] (
	"LevelId"		integer NOT NULL,
	"EntityId"		integer NOT NULL,
    PRIMARY KEY ([LevelId], [EntityId])
,
    FOREIGN KEY ([LevelId])
        REFERENCES [Level]([Id]),
    FOREIGN KEY ([EntityId])
        REFERENCES [Entity]([Id])
);

CREATE TABLE [SavedGame] (
	"Id"		integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	"Name"		varchar(50) NOT NULL,
	"LevelId"	integer NOT NULL
,
    FOREIGN KEY ([LevelId])
        REFERENCES [Level]([Id])
);

CREATE UNIQUE INDEX [UX_SavedGame]
ON [SavedGame]
([Name]);

CREATE TABLE [SavedGame_Entity] (
	"SavedGameId"		integer NOT NULL,
	"EntityId"		integer NOT NULL,
    PRIMARY KEY ([SavedGameId], [EntityId])
,
    FOREIGN KEY ([SavedGameId])
        REFERENCES [SavedGame]([Id]),
    FOREIGN KEY ([EntityId])
        REFERENCES [Entity]([Id])
);